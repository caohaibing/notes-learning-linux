<!DOCTYPE HTML>
<html lang="en-US">
    <head prefix="og: http://ogp.me/ns# book: http://ogp.me/ns/book#">
        
        <meta charset="UTF-8">
        <title>linux系统的开机启动过程 | note-learning-linux</title>

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="robots" content="index, follow">
        <meta name="author" content="xionglie">
        <meta name="description" content="将以前学习linux的笔记整理出来，形成这本电子书">
        <meta name="keywords" content="gitbook,github" >
        <meta name="generator" content="www.gitbook.io">

        
        <link rel="next" href="../Chapter02/README.html" />
        
        
        <link rel="prev" href="../Chapter01/KeyMap.html" />
        

        <meta property="og:title" content="linux系统的开机启动过程 | note-learning-linux">
        <meta property="og:site_name" content="note-learning-linux">
        <meta property="og:type" content="book">
        <meta property="og:locale" content="en_US">

        <meta property="book:author" content="https://github.com/xionglie">
        <meta property="book:tag" content="GitBook">

        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">

        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    </head>
    <body>
        

        <link rel="stylesheet" href="../gitbook/style.css">
        


        
    <div class="book" data-github="xionglie/note-learning-linux" data-level="1.4" data-basepath=".." data-revision="1399346320580">
    <div class="book-header">
    <!-- Actions Left -->
    
    <a href="https://github.com/xionglie/note-learning-linux" target="_blank" class="btn pull-left"><i class="fa fa-github-alt"></i></a>
    
    <a href="#" class="btn pull-left toggle-summary"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search"><i class="fa fa-search"></i></a>
    <span id="font-settings-wrapper">
        <a href="#" class="btn pull-left toggle-font-settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
	<div class="dropdown-caret">
  <span class="caret-outer"></span>
  <span class="caret-inner"></span>
</div>

	<div class="btn-group btn-block">
		<button id="reduce-font-size" class="btn btn-default">A</button>
		<button id="enlarge-font-size" class="btn btn-default">A</button>
	</div>

	<ul class="list-group font-family-list">
		<li class="list-group-item" data-font="0">Serif</li>
		<li class="list-group-item" data-font="1">Sans</li>
	</ul>

	<div class="btn-group btn-group-xs btn-block color-theme-list">
	  <button type="button" class="btn btn-default" id="color-theme-preview-0" data-theme="0">White</button>
	  <button type="button" class="btn btn-default" id="color-theme-preview-1" data-theme="1">Sepia</button>
	  <button type="button" class="btn btn-default" id="color-theme-preview-2" data-theme="2">Night</button>
	</div>
</div>

    </span>

    <!-- Actions Right -->
    <a href="#" target="_blank" class="btn pull-right" data-sharing="google-plus"><i class="fa fa-google-plus"></i></a>
    <a href="#" target="_blank" class="btn pull-right" data-sharing="facebook"><i class="fa fa-facebook"></i></a>
    <a href="#" target="_blank" class="btn pull-right" data-sharing="twitter"><i class="fa fa-twitter"></i></a>

    
    <a href="https://github.com/xionglie/note-learning-linux/stargazers" target="_blank" class="btn pull-right count-star"><i class="fa fa-star-o"></i> Star (<span>-</span>)</a>
    <a href="https://github.com/xionglie/note-learning-linux/watchers" target="_blank" class="btn pull-right count-watch"><i class="fa fa-eye"></i> Watch (<span>-</span>)</a>
    

    <!-- Title -->
    <h1><a href="../" >note-learning-linux</a></h1>
</div>

    <div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Search" class="form-control" />
    </div>
    <ul class="summary">
        
        <li>
            <a href="https://github.com/xionglie" target="blank">About the author</a>
        </li>
        <li>
            <a href="https://github.com/xionglie/note-learning-linux/issues" target="blank">Questions and Issues</a>
        </li>
        <li>
            <a href="https://github.com/xionglie/note-learning-linux/edit/master/Chapter01/BootProcess.md" target="blank">Edit and Contribute</a>
        </li>
        <li class="divider"></li>
        
        <li data-level="0" data-path="index.html">
            <a href="../"><i class="fa fa-check"></i> Introduction</a>
        </li>
        
            <li  data-level="1" data-path="Chapter01/README.html">
                
                <a href="../Chapter01/README.html">
                    <i class="fa fa-check"></i> <b>1.</b> linux基础: 安装与应用
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="1.1" data-path="Chapter01/InstallCentos5x.html">
                            
                            <a href="../Chapter01/InstallCentos5x.html">
                                <i class="fa fa-check"></i> <b>1.1.</b> centos5.6系统安装
                            </a>
                            
                        </li>
                    
                        <li  data-level="1.2" data-path="Chapter01/InstallCentos6x.html">
                            
                            <a href="../Chapter01/InstallCentos6x.html">
                                <i class="fa fa-check"></i> <b>1.2.</b> centos6.x系统安装
                            </a>
                            
                        </li>
                    
                        <li  data-level="1.3" data-path="Chapter01/KeyMap.html">
                            
                            <a href="../Chapter01/KeyMap.html">
                                <i class="fa fa-check"></i> <b>1.3.</b> linux下常用的命令快捷键
                            </a>
                            
                        </li>
                    
                        <li  data-level="1.4" data-path="Chapter01/BootProcess.html">
                            
                            <a href="../Chapter01/BootProcess.html">
                                <i class="fa fa-check"></i> <b>1.4.</b> linux系统的开机启动过程
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li  data-level="2" data-path="Chapter02/README.html">
                
                <a href="../Chapter02/README.html">
                    <i class="fa fa-check"></i> <b>2.</b> linux配置与优化
                </a>
                
                
            </li>
        
            <li  data-level="3" data-path="Chapter03/README.html">
                
                <a href="../Chapter03/README.html">
                    <i class="fa fa-check"></i> <b>3.</b> linux定时任务
                </a>
                
                
            </li>
        
            <li  data-level="4" data-path="Chapter04/README.html">
                
                <a href="../Chapter04/README.html">
                    <i class="fa fa-check"></i> <b>4.</b> linux磁盘管理
                </a>
                
                
            </li>
        
            <li  data-level="5" data-path="Chapter05/README.html">
                
                <a href="../Chapter05/README.html">
                    <i class="fa fa-check"></i> <b>5.</b> linux nfs
                </a>
                
                
            </li>
        
            <li  data-level="6" data-path="Chapter06/README.html">
                
                <a href="../Chapter06/README.html">
                    <i class="fa fa-check"></i> <b>6.</b> linux 文件分发
                </a>
                
                
            </li>
        
            <li  data-level="7" data-path="Chapter07/README.html">
                
                <a href="../Chapter07/README.html">
                    <i class="fa fa-check"></i> <b>7.</b> linux apache
                </a>
                
                
            </li>
        
            <li  data-level="8" data-path="Chapter08/README.html">
                
                <a href="../Chapter08/README.html">
                    <i class="fa fa-check"></i> <b>8.</b> linux myql
                </a>
                
                
            </li>
        
            <li  data-level="9" data-path="Chapter09/README.html">
                
                <a href="../Chapter09/README.html">
                    <i class="fa fa-check"></i> <b>9.</b> linux PHP
                </a>
                
                
            </li>
        
            <li  data-level="10" data-path="Chapter10/README.html">
                
                <a href="../Chapter10/README.html">
                    <i class="fa fa-check"></i> <b>10.</b> linux Lvs负载均衡及Keepalived
                </a>
                
                
            </li>
        
            <li  data-level="11" data-path="Chapter11/README.html">
                
                <a href="../Chapter11/README.html">
                    <i class="fa fa-check"></i> <b>11.</b> linux Nagios监控服务
                </a>
                
                
            </li>
        
            <li  data-level="12" data-path="Chapter12/README.html">
                
                <a href="../Chapter12/README.html">
                    <i class="fa fa-check"></i> <b>12.</b> linux iptables防火墙
                </a>
                
                
            </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="page-wrapper" tabindex="-1">
                <div class="book-progress">
    <div class="bar">
        <div class="inner" style="width: 31.25%;min-width: 25%;"></div>
    </div>
    <div class="chapters">
    
        <a href="../index.html" title="Introduction" class="chapter done new-chapter" data-progress="0" style="left: 0%;"></a>
    
        <a href="../Chapter01/README.html" title="linux基础: 安装与应用" class="chapter done new-chapter" data-progress="1" style="left: 6.25%;"></a>
    
        <a href="../Chapter01/InstallCentos5x.html" title="centos5.6系统安装" class="chapter done " data-progress="1.1" style="left: 12.5%;"></a>
    
        <a href="../Chapter01/InstallCentos6x.html" title="centos6.x系统安装" class="chapter done " data-progress="1.2" style="left: 18.75%;"></a>
    
        <a href="../Chapter01/KeyMap.html" title="linux下常用的命令快捷键" class="chapter done " data-progress="1.3" style="left: 25%;"></a>
    
        <a href="../Chapter01/BootProcess.html" title="linux系统的开机启动过程" class="chapter done " data-progress="1.4" style="left: 31.25%;"></a>
    
        <a href="../Chapter10/README.html" title="linux Lvs负载均衡及Keepalived" class="chapter  " data-progress="10" style="left: 37.5%;"></a>
    
        <a href="../Chapter11/README.html" title="linux Nagios监控服务" class="chapter  " data-progress="11" style="left: 43.75%;"></a>
    
        <a href="../Chapter12/README.html" title="linux iptables防火墙" class="chapter  " data-progress="12" style="left: 50%;"></a>
    
        <a href="../Chapter02/README.html" title="linux配置与优化" class="chapter  new-chapter" data-progress="2" style="left: 56.25%;"></a>
    
        <a href="../Chapter03/README.html" title="linux定时任务" class="chapter  new-chapter" data-progress="3" style="left: 62.5%;"></a>
    
        <a href="../Chapter04/README.html" title="linux磁盘管理" class="chapter  new-chapter" data-progress="4" style="left: 68.75%;"></a>
    
        <a href="../Chapter05/README.html" title="linux nfs" class="chapter  new-chapter" data-progress="5" style="left: 75%;"></a>
    
        <a href="../Chapter06/README.html" title="linux 文件分发" class="chapter  new-chapter" data-progress="6" style="left: 81.25%;"></a>
    
        <a href="../Chapter07/README.html" title="linux apache" class="chapter  new-chapter" data-progress="7" style="left: 87.5%;"></a>
    
        <a href="../Chapter08/README.html" title="linux myql" class="chapter  new-chapter" data-progress="8" style="left: 93.75%;"></a>
    
        <a href="../Chapter09/README.html" title="linux PHP" class="chapter  new-chapter" data-progress="9" style="left: 100%;"></a>
    
    </div>
</div>

                <div class="page-inner">
                
                    <section class="normal" id="section-gitbook_2">
                    
                        <h1 id="linux-">linux系统的开机启动过程</h1>
<pre><code>目录
目录    1
1.    启动流程    1
1.1.    BIOS,boot loader与kernel载入    2
1.2.    第一个程序init及配置文件/etc/inittab与 runlevel    3
1.3.    init 处理系统初始化流程/etc/rc.d/rc.sysinit    5
1.3.1.    启动系统服务与相关启动配置文件/etc/rc.d/rc.n 与/etc/sysconfig    5
1.4.    用户自定义开机启动程序 (/etc/rc.d/rc.local)    6
1.5.    根据/etc/inittab之设置，加载终端或X-Window    6
</code></pre><h1 id="1-">1.    启动流程</h1>
<p>(1)    BIOS自检--加载 BIOS 的硬件信息与进行自我测试，并根据配置取得第一个可启动的设备；</p>
<p>(2)    MBR引导--读取并运行第一个启动装置内MBR的boot Loader (即grub, spfdisk 等程序)；</p>
<p>(3)    加载内核kernel--根据boot loader的配置加载 Kernel ，Kernel会开始检测硬件与加载驱动程序；</p>
<p>(4)    启动init进程--在硬件驱动成功后，Kernel会主动调init进程，而init会取得run-level信息；</p>
<p>(5)    init 运行/etc/rc.d/rc.sysinit文件来准备软件运行的操作环境(如网络、时区等)；</p>
<p>(6)    init 运行run-level的各个服务之启动(script 方式)；</p>
<p>(7)    init 运行/etc/rc.d/rc.local 文件；</p>
<p>(8)    init 运行终端机模拟程序mingetty来启动login 程序，最后就等待用户登录；</p>
<p><img src="../img/startup/img1.jpg" alt=""></p>
<h2 id="1-1-bios-boot-loader-kernel-">1.1.    BIOS,boot loader与kernel载入</h2>
<h3 id="bios-mbr">BIOS，开机自检与MBR</h3>
<p>(1)    主机在开机的时候，读取BIOS。</p>
<p>(2)    系统会根据读取的BIOS的数据，进行加电自检 (power on self test, POST)， 然后开始执行初始化硬件检测，并设置 PnP 设备，确定可开机的设备后，就开始读取启动设备的数据 (MBR 相关的任务开始)。</p>
<p>(3)    主机开始尝试由存储媒体加载操作系统。系统开始在第一台启动设备上执行开机程序。以硬盘为例，启动流程读硬盘的过程中，第一个要读取的就是该硬盘的主引导扇区 (Master Boot Record, MBR) ，而系统可以由主引导扇区所安装的引导加载程序 (boot loader) 开始执行核心识别的工作。</p>
<h3 id="boot-loader-">boot loader：认识操作系统文件格式并据以加载内核到内存中执行。</h3>
<p>(4)    boot loader开始读取核心文件后，Linux会将内核解压到内存中， 并且利用内核的功能，开始测试与驱动各个外部设备，包括存储设备、CPU、网络卡、声卡等等。内核开始接管BIOS后工作。核心文件一般放在/boot里， 并且取名为/boot/vmlinuz。</p>
<p>(5)    在加载核心的过程中，系统只会&quot;挂载根目录&quot;而已，而且是以只读的方式挂载的。 此外，有时为了让某些功能可以用文件方式来读取，因此，有的系统在开机的时候， 会建立虚拟硬盘 (RAM Disk)，这就需要 initrd 及 linuxrc了。</p>
<p>(6)    在核心驱动外部硬件的工作完成之后， initrd 所建立的虚拟磁盘就会被删除了！</p>
<p>boot loader 可以加载 kernel 与 initrd ，然后在内存中让 initrd 解压成为根目录， kernel 就能够借此加载适当的驱动程序，最终释放虚拟文件系统，并挂载实际的根目录文件系统， 就能够开始后续的正常启动流程。
在完整加载内核后，主机开始正确的运行。
<img src="../img/startup/img2.png" alt=""></p>
<h2 id="1-2-init-etc-inittab-runlevel">1.2.    第一个程序init及配置文件/etc/inittab与 runlevel</h2>
<p>在核心加载完毕之后，整个Linux当中第一个被执行的程序就是/sbin/init。/sbin/init 最主要的功能就是准备软件运行的环境，包括系统的主机名、网络配置、语系处理、文件系统格式及其他服务的启动等。</p>
<p>而所有的动作都会通过init的配置文件，即/etc/inittab 来规划，而 inittab 内还有一个很重要的设置选项，那就是默认的run level (启动运行等级)</p>
<p>run level 分为六个等级，分别是：</p>
<p>0 - halt (系统直接关机)</p>
<p>1 - single user mode (单人维护模式，用于系统出问题时的维护)</p>
<p>2 - Multi-user, without NFS (类似下面的 runlevel 3，但无 NFS 服务)</p>
<p>3 - Full multi-user mode (完整网络功能的纯文本模式)</p>
<p>4 - unused (系统保留功能)</p>
<p>5 - X11 (与 runlevel 3 类似，但加载使用 X Window)</p>
<p>6 - reboot (重新启动)</p>
<p>开机时，从/etc/inittab取得系统的 run level的。</p>
<pre><code class="lang-bash">[root@linux ~]<span class="hljs-comment"># vi /etc/inittab</span>
<span class="hljs-comment"># 设置系统开机默认的 run level 设置项目：</span>
id:<span class="hljs-number">3</span>:initdefault:

<span class="hljs-comment"># 准备系统软件执行环境的脚本执行文件</span>
si::sysinit:/etc/rc.d/rc.sysinit

<span class="hljs-comment"># 7 个不同 run level 的，需要启动的服务的脚本放置路径：</span>
l0:<span class="hljs-number">0</span>:wait:/etc/rc.d/rc <span class="hljs-number">0</span>    &lt;==runlevel <span class="hljs-number">0</span> 在 /etc/rc.d/rc0.d/
l1:<span class="hljs-number">1</span>:wait:/etc/rc.d/rc <span class="hljs-number">1</span>    &lt;==runlevel <span class="hljs-number">1</span> 在 /etc/rc.d/rc1.d/
l2:<span class="hljs-number">2</span>:wait:/etc/rc.d/rc <span class="hljs-number">2</span>    &lt;==runlevel <span class="hljs-number">2</span> 在 /etc/rc.d/rc2.d/
l3:<span class="hljs-number">3</span>:wait:/etc/rc.d/rc <span class="hljs-number">3</span>    &lt;==runlevel <span class="hljs-number">3</span> 在 /etc/rc.d/rc3.d/
l4:<span class="hljs-number">4</span>:wait:/etc/rc.d/rc <span class="hljs-number">4</span>    &lt;==runlevel <span class="hljs-number">4</span> 在 /etc/rc.d/rc4.d/
l5:<span class="hljs-number">5</span>:wait:/etc/rc.d/rc <span class="hljs-number">5</span>    &lt;==runlevel <span class="hljs-number">5</span> 在 /etc/rc.d/rc5.d/
l6:<span class="hljs-number">6</span>:wait:/etc/rc.d/rc <span class="hljs-number">6</span>    &lt;==runlevel <span class="hljs-number">6</span> 在 /etc/rc.d/rc6.d/

<span class="hljs-comment"># 是否允许按下 [ctrl]+[alt]+[del] 就重新启动的设置项目：</span>
ca::ctrlaltdel:/sbin/shutdown -t3 -r now

<span class="hljs-comment"># 下面两个配置则是关于不断电系统的 (UPS)，一个是没电时的关机，一个是复电的处理</span>
pf::powerfail:/sbin/shutdown <span class="hljs-operator">-f</span> -h +<span class="hljs-number">2</span> <span class="hljs-string">"Power Failure; System Shutting Down"</span>
pr:<span class="hljs-number">12345</span>:powerokwait:/sbin/shutdown -c <span class="hljs-string">"Power Restored; Shutdown Cancelled"</span>

<span class="hljs-comment"># 本机终端启动的个数：</span>
<span class="hljs-number">1</span>:<span class="hljs-number">2345</span>:respawn:/sbin/mingetty tty1
<span class="hljs-number">2</span>:<span class="hljs-number">2345</span>:respawn:/sbin/mingetty tty2
<span class="hljs-number">3</span>:<span class="hljs-number">2345</span>:respawn:/sbin/mingetty tty3
<span class="hljs-number">4</span>:<span class="hljs-number">2345</span>:respawn:/sbin/mingetty tty4
<span class="hljs-number">5</span>:<span class="hljs-number">2345</span>:respawn:/sbin/mingetty tty5
<span class="hljs-number">6</span>:<span class="hljs-number">2345</span>:respawn:/sbin/mingetty tty6

<span class="hljs-comment"># 在 X Window (run level 5) 环境下的启动脚本设置项目：</span>
x:<span class="hljs-number">5</span>:once:/etc/X11/prefdm –nodaemon
</code></pre>
<p>/etc/inittab文件的语法如下：</p>
<p>[设置项目]:[run level]:[init 的动作行为]:[命令项目]</p>
<p>1). 设置项目：</p>
<p>   最多四个字符，代表 init 的主要工作项目，只是一个简单的代表说明。</p>
<p>2). run level：</p>
<p>   该项目在哪些 run level 下面进行的意思。如果是35则代表 runlevel 3 与 5 都会执行。</p>
<p>3). init 的动作项目：</p>
<p>   主要项目意义如下：
   initdefault：    代表默认的 run level 设置值；
   sysinit    ：        代表系统初始化的动作项目；
   ctrlaltdel    ：    代表 [ctrl]+[alt]+[del] 三个按键是否可以重新启动的设置；
   wait        ：        代表后面接的命令项目必须要执行完毕,才能继续后面的动作；
   respawn    ：        代表后面接的init 仍会主动的&quot;重新&quot;启动。
   更多的设置项目请参考 man inittab 的说明。</p>
<p>4). 命令项目：
   即应该可以进行的命令，通常是一些脚本。</p>
<p>CentOS中init的处理流程是：</p>
<pre><code>(1)    先取得 runlevel ，即默认运行等级的相关等级 (以鸟哥的测试机为例，为5号)；
(2)    使用 /etc/rc.d/rc.sysinit 进行系统初始化
(3)    由于runlevel是5 ，因此只进行『l5:5:wait:/etc/rc.d/rc 5』，其他行则略过
(4)    配置好 [ctrl]+[alt]+[del] 这组的组合键功能
(5)    配置不断电系统的 pf, pr 两种机制；
(6)    启动 mingetty 的六个终端机 (tty1 ~ tty6)
(7)    最终以/etc/X11/perfdm -nodaemon 启动图形界面！
</code></pre><h2 id="1-3-init-etc-rc-d-rc-sysinit">1.3.    init 处理系统初始化流程/etc/rc.d/rc.sysinit</h2>
<p>开始加载各项系统服务之前，先设置好整个系统环境，主要利用 /etc/rc.d/rc.sysinit 这个脚本来设置系统环境。</p>
<p>/etc/rc.d/rc.sysinit主要的工作：</p>
<pre><code>1.取得网络环境与主机类型：
首先读取网络配置文件 /etc/sysconfig/network ，取得主机名与默认网关 (gateway) 等网络环境。
2.测试与挂载内存设备/proc及 USB设备/sys：
除挂载内存设备/proc 之外，还会主动检测系统上是否具有usb设备， 若有则会主动加载usb的驱动程序，并且尝试挂载usb的文件系统。
3.决定是否启动 SELinux ：

4.启动系统的随机数产生器
随机数产生器可以帮助系统进行一些密码加密演算的功能，在此需要启动两次随机数产生器。
5.配置终端机 (console) 字体：
6.配置显示于启动过程中的欢迎画面 (text banner)；
7.配置系统时间 (clock) 与时区配置：需读入 /etc/sysconfig/clock 配置值
8.接口设备的检测与 即插即用 (PnP) 参数的测试：
9.用户自定义模块的加载
10.加载核心的相关配置：
11.配置主机名与初始化电源管理模块 (ACPI)
12.初始化软件磁盘阵列：主要是透过 /etc/mdadm.conf 来配置好的。
13.初始化 LVM 的文件系统功能
14.以 fsck 检验磁盘文件系统：会进行 filesystem check
15.进行磁盘配额 quota 的转换 (非必要)：
16.重新以可读写模式挂载系统磁碟：
17.启动 quota 功能：所以我们不需要自订 quotaon 的动作
18.启动系统伪随机数产生器 (pseudo-random)：
19.清除启动过程当中的缓存文件：
20.将启动相关信息加载 /var/log/dmesg 文件中。
</code></pre><h3 id="1-3-1-etc-rc-d-rc-n-etc-sysconfig">1.3.1.    启动系统服务与相关启动配置文件/etc/rc.d/rc.n 与/etc/sysconfig</h3>
<pre><code class="lang-bash">[root@stu412 ~]<span class="hljs-comment"># ls -l /etc/rc.d/rc3.d</span>
total <span class="hljs-number">320</span>
lrwxrwxrwx <span class="hljs-number">1</span> root root <span class="hljs-number">17</span> Jun  <span class="hljs-number">4</span> <span class="hljs-number">03</span>:<span class="hljs-number">34</span> K01dnsmasq -&gt; ../init.d/dnsmasq
lrwxrwxrwx <span class="hljs-number">1</span> root root <span class="hljs-number">24</span> Jun  <span class="hljs-number">4</span> <span class="hljs-number">03</span>:<span class="hljs-number">34</span> K02avahi-dnsconfd -&gt; ../init.d/avahi-dnsconfd
lrwxrwxrwx <span class="hljs-number">1</span> root root <span class="hljs-number">24</span> Jun  <span class="hljs-number">4</span> <span class="hljs-number">03</span>:<span class="hljs-number">35</span> K02NetworkManager -&gt; ../init.d/NetworkManager
lrwxrwxrwx <span class="hljs-number">1</span> root root <span class="hljs-number">17</span> Jun  <span class="hljs-number">4</span> <span class="hljs-number">03</span>:<span class="hljs-number">34</span> K02oddjobd -&gt; ../init.d/oddjobd
lrwxrwxrwx <span class="hljs-number">1</span> root root <span class="hljs-number">16</span> Jun  <span class="hljs-number">4</span> <span class="hljs-number">03</span>:<span class="hljs-number">33</span> K05conman -&gt; ../init.d/conman
lrwxrwxrwx <span class="hljs-number">1</span> root root <span class="hljs-number">14</span> Jun  <span class="hljs-number">4</span> <span class="hljs-number">03</span>:<span class="hljs-number">34</span> K05innd -&gt; ../init.d/innd
lrwxrwxrwx <span class="hljs-number">1</span> root root <span class="hljs-number">19</span> Jun  <span class="hljs-number">4</span> <span class="hljs-number">03</span>:<span class="hljs-number">34</span> K05saslauthd -&gt; ../init.d/saslauthd
...
lrwxrwxrwx <span class="hljs-number">1</span> root root <span class="hljs-number">25</span> Jun  <span class="hljs-number">4</span> <span class="hljs-number">03</span>:<span class="hljs-number">34</span> K99readahead_later -&gt; ../init.d/readahead_later
lrwxrwxrwx <span class="hljs-number">1</span> root root <span class="hljs-number">23</span> Jun  <span class="hljs-number">4</span> <span class="hljs-number">03</span>:<span class="hljs-number">34</span> S00microcode_ctl -&gt; ../init.d/microcode_ctl
lrwxrwxrwx <span class="hljs-number">1</span> root root <span class="hljs-number">25</span> Jun  <span class="hljs-number">4</span> <span class="hljs-number">03</span>:<span class="hljs-number">34</span> S04readahead_early -&gt; ../init.d/readahead_early
lrwxrwxrwx <span class="hljs-number">1</span> root root <span class="hljs-number">15</span> Jun  <span class="hljs-number">4</span> <span class="hljs-number">03</span>:<span class="hljs-number">35</span> S05kudzu -&gt; ../init.d/kudzu
...
</code></pre>
<p>一般来说，如果我们想要启动一些系统服务，例如启动 atd ， 需要使用：
/etc/rc.d/init.d/atd start    (也可以用 /etc/init.d/atd start)
如果是关闭该服务，就是使用：
/etc/rc.d/init.d/atd stop</p>
<p>(1)    在 /etc/rc.d/rc3.d 内的，以 S 为开头的文件，为开机时，需要&quot;启动, start&quot;的服务；</p>
<p>(2)    在该目录内的 K 为开头的文件，为&quot;关机时需要关闭的服务, stop&quot;的文件连结；</p>
<p>(3)    在 S 与 K 后面接的数字，代表该文件被执行的顺序。</p>
<h2 id="1-4-etc-rc-d-rc-local-">1.4.    用户自定义开机启动程序 (/etc/rc.d/rc.local)</h2>
<p>有任何想要在开机时就进行的工作时，直接将他写入/etc/rc.d/rc.local ， 那么该工作就会在开机的时候自动被加载！而不必等我们登录系统去启动。</p>
<p>rc.local服务是在/etc/rc.d/rc*.d里执行的</p>
<pre><code class="lang-bash">[root@stu412 test]<span class="hljs-comment"># ls -l /etc/rc.d/rc3.d | grep local</span>
lrwxrwxrwx <span class="hljs-number">1</span> root root <span class="hljs-number">11</span> Jun  <span class="hljs-number">4</span> <span class="hljs-number">03</span>:<span class="hljs-number">34</span> S99local -&gt; ../rc.local
</code></pre>
<h2 id="1-5-etc-inittab-x-window">1.5.    根据/etc/inittab之设置，加载终端或X-Window</h2>
<p>在完成了系统所有服务的启动后，接下来 Linux 就会启动终端或者是 X Window 来等待用户登录！ 实际参考的项目是 /etc/inittab 内的这一段：</p>
<pre><code>1:2345:respawn:/sbin/mingetty tty1
2:2345:respawn:/sbin/mingetty tty2
3:2345:respawn:/sbin/mingetty tty3
4:2345:respawn:/sbin/mingetty tty4
5:2345:respawn:/sbin/mingetty tty5
6:2345:respawn:/sbin/mingetty tty6

# Run xdm in runlevel 5
x:5:once:/etc/X11/prefdm -nodaemon
</code></pre><p>这一段代表，在 run level 2, 3, 4, 5 时，都会执行 /sbin/mingetty ， 而且执行六个，这也是为何我们 Linux 会提供&quot;六个纯文本终端&quot;的设置！ 因为 mingetty 是启动终端的命令。</p>

                    
                    </section>
                
                </div>
            </div>
        </div>

        
        <a href="../Chapter01/KeyMap.html" class="navigation navigation-prev"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../Chapter02/README.html" class="navigation navigation-next"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        

        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/ace.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/mode-javascript.js"></script>
        <script src="../gitbook/jsrepl/jsrepl.js" id="jsrepl-script"></script>
        <script src="../gitbook/app.js"></script>
        

    
    <script src="../gitbook/plugins/gitbook-plugin-mixpanel/plugin.js"></script>
    

    
    <script src="http://cdn.mathjax.org/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-mathjax/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {};
    gitbook.start(config);
});
</script>

    </body>
</html>
